<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>template sketch</title>
</head>
<body>
    <script defer>
        class HashSeededRandom {
            constructor(hash) {
                this.a = parseInt(hash, 16);
            }

            rand() { /* mulberry32 from https://github.com/bryc/code/blob/master/jshash/PRNGs.md */
                this.a |= 0;
                this.a = this.a + 0x6D2B79F5 | 0;
                let t = Math.imul(this.a ^ this.a >>> 15, 1 | this.a);
                t = t + Math.imul(t ^ t >>> 7, 61 | t) ^ t;
                return ((t ^ t >>> 14) >>> 0) / 4294967296;
            }
        }

        class Hash {
            static async getStringHash(inputString, hashLength = 12) {
                if (!inputString || typeof inputString !== 'string') {
                    throw new Error('Invalid input string');
                }

                if (!hashLength || typeof hashLength !== 'number' || hashLength < 1) {
                    throw new Error('Invalid hash length');
                }

                const msgUint8 = new TextEncoder().encode(inputString);
                const hashBuffer = await window.crypto.subtle.digest("SHA-256", msgUint8);

                const hashHex = new Uint8Array(hashBuffer).toHex();

                return hashHex.substring(0, hashLength);
            }
        }

        let hashRand = undefined;

        async function init() {
            const params = new URLSearchParams(window.location.search);

            if (params.get('seedString')) {
                const hash = await Hash.getStringHash(params.get('seedString'));

                const TOKEN_DATA = {
                    tokenHash: hash
                }

                hashRand = new HashSeededRandom(TOKEN_DATA.tokenHash);
            } else {
                hashRand = undefined;
            }
        }

        init();
    </script>
</body>
</html>
